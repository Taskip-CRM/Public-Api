# Inbox Management API

The Inbox Management API provides comprehensive email conversation handling and communication management capabilities. This powerful API allows you to manage email threads, assign tags, reply to conversations, and organize your communication workflow efficiently.

## Overview

Inbox Management consists of multiple communication features:
- **Conversation Management**: Handle email threads and conversations
- **Message Handling**: Send and receive messages within conversations
- **Tag Assignment**: Organize conversations with tags and labels
- **Reply System**: Respond to emails and maintain conversation flow
- **Inbox Configuration**: Manage inbox settings and email addresses
- **Team Assignment**: Assign conversations to team members
- **Thread Organization**: Group related messages together

## Main Endpoints Overview

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | [`/api/public-v1/inbox/conversation/all`](#get-all-conversations) | Get all inbox conversations |
| `POST` | [`/api/public-v1/inbox/conversation/new-message`](#create-new-messageconversation) | Create a new message/conversation |
| `POST` | [`/api/public-v1/inbox/conversation/{uuid}/reply`](#reply-to-conversation) | Reply to a conversation |
| `POST` | [`/api/public-v1/inbox/conversation/{uuid}/assign-tags`](#assign-tags-to-conversation) | Assign tags to a conversation |
| `GET` | [`/api/public-v1/get-email-address`](#get-email-address) | Get inbox email address |
| `PUT` | [`/api/public-v1/inbox/assign-tags/{id}`](#update-tag-assignment) | Update tag assignments |
| `DELETE` | [`/api/public-v1/inbox/assign-tags/{id}`](#remove-tag-assignment) | Remove tag assignments |

---

## Get All Conversations

Retrieve all email conversations from your inbox.

```http
GET /api/public-v1/inbox/conversation/all
```

### Request Headers
```http
X-Secret-Key: your-secret-key-here
Content-Type: application/json
```

### Query Parameters
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `page` | integer | No | Page number for pagination (default: 1) |
| `limit` | integer | No | Number of conversations per page (default: 50) |
| `status` | string | No | Filter by status (`unread`, `read`, `archived`) |
| `tag_id` | integer | No | Filter by tag ID |
| `assigned_to` | integer | No | Filter by assigned team member |
| `date_from` | date | No | Filter conversations from date (YYYY-MM-DD) |
| `date_to` | date | No | Filter conversations to date (YYYY-MM-DD) |
| `search` | string | No | Search term for subject or content |
| `sort` | string | No | Sort field (`created_at`, `updated_at`, `subject`) |
| `order` | string | No | Sort order (`asc` or `desc`) |

<ApiTester
  endpoint="/api/public-v1/inbox/conversation/all"
  method="GET"
  description="Test getting all inbox conversations with optional filtering"
/>

### Example Request

```bash
curl -X GET "https://public-api.taskip.net/api/public-v1/inbox/conversation/all?status=unread&limit=20" \
  -H "X-Secret-Key: your-secret-key-here" \
  -H "Content-Type: application/json"
```

### Example Response

```json
{
  "data": [
    {
      "message_id": "msg_abc123def456",
      "in_reply_to": null,
      "reply_to": "john.doe@client.com",
      "from_email": "support@taskip.net",
      "from_name": "TaskIP Support",
      "to_email": "john.doe@client.com",
      "subject": "Project Discussion - Website Redesign",
      "is_read": false,
      "created_at": "2 hours ago",
      "uuid": "conv_abc123def456",
      "body_plain": "Looking forward to the updated mockups and design concepts for the new website. Please let me know if you need any additional information or resour...",
      "tags": [
        {
          "id": 1,
          "title": "Client Communication",
          "color": "blue",
          "type": "project"
        },
        {
          "id": 3,
          "title": "High Priority",
          "color": "red",
          "type": "priority"
        }
      ],
      "replied_by": {
        "id": 12,
        "name": "Jane Smith",
        "email": "jane@taskip.com"
      },
      "send_type": true
    }
  ],
  "links": {
    "first": "https://public-api.taskip.net/api/public-v1/inbox/conversation/all?page=1",
    "last": "https://public-api.taskip.net/api/public-v1/inbox/conversation/all?page=3",
    "prev": null,
    "next": "https://public-api.taskip.net/api/public-v1/inbox/conversation/all?page=2"
  },
  "meta": {
    "current_page": 1,
    "from": 1,
    "last_page": 3,
    "path": "https://public-api.taskip.net/api/public-v1/inbox/conversation/all",
    "per_page": 15,
    "to": 15,
    "total": 45
  }
}
```

---

## Create New Message/Conversation

Start a new email conversation or send a new message.

```http
POST /api/public-v1/inbox/conversation/new-message
```

### Request Headers
```http
X-Secret-Key: your-secret-key-here
Content-Type: application/json
```

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `to_emails` | array | Yes | Array of recipient email addresses |
| `subject` | string | Yes | Email subject |
| `message` | string | No | Message content (HTML supported) |
| `cc` | string | No | Comma-separated CC recipient emails |
| `bcc` | string | No | Comma-separated BCC recipient emails |
| `from_email` | string | No | Sender email (uses connected email if not provided) |
| `template_id` | integer | No | Email template ID to use |

<ApiTester
  endpoint="/api/public-v1/inbox/conversation/new-message"
  method="POST"
  defaultBody={{
    to: "client@example.com",
    subject: "Project Update - Website Development",
    content: "<p>Hi there,</p><p>I wanted to provide you with an update on the website development project...</p><p>Best regards,<br>Your Team</p>",
    cc: ["manager@taskip.com"],
    tags: [1, 3],
    priority: "normal",
    send_copy_to_self: true
  }}
  description="Test creating a new message/conversation"
/>

### Example Request

```bash
curl -X POST "https://public-api.taskip.net/api/public-v1/inbox/conversation/new-message" \
  -H "X-Secret-Key: your-secret-key-here" \
  -H "Content-Type: application/json" \
  -d '{
    "to_emails": ["client@example.com"],
    "subject": "Project Update - Website Development", 
    "message": "<p>Hi there,</p><p>I wanted to provide you with an update...</p>",
    "cc": "manager@taskip.com",
    "bcc": "archive@taskip.com"
  }'
```

### Example Response

```json
{
  "data": {
    "message_id": "msg_xyz789abc123",
    "in_reply_to": null,
    "reply_to": "client@example.com",
    "from_email": "support@taskip.net",
    "from_name": "TaskIP Support",
    "to_email": "client@example.com",
    "subject": "Project Update - Website Development",
    "is_read": true,
    "created_at": "just now",
    "uuid": "conv_xyz789abc123",
    "body_plain": "Hi there, I wanted to provide you with an update on the website development project. We have made significant progress and should have the initial...",
    "tags": [],
    "replied_by": null,
    "send_type": true
  },
  "msg": "Message Send Successful"
}
```

---

## Reply to Conversation

Reply to an existing email conversation.

```http
POST /api/public-v1/inbox/conversation/{uuid}/reply
```

### Path Parameters
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `uuid` | string | Yes | Conversation UUID |

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `message` | string | Yes | Reply content (HTML supported) |
| `reply_all` | boolean | No | Reply to all participants (default: false) |
| `attachments` | array | No | Array of attachment file IDs |
| `internal_note` | boolean | No | Mark as internal team note |

<ApiTester
  endpoint="/api/public-v1/inbox/conversation/conv-abc123def456/reply"
  method="POST"
  defaultBody={{
    content: "<p>Thank you for your message.</p><p>I'll review the details and get back to you shortly.</p><p>Best regards,<br>Support Team</p>",
    reply_all: false,
    internal_note: false,
    mark_resolved: false
  }}
  description="Test replying to a conversation"
/>

### Example Request

```bash
curl -X POST "https://public-api.taskip.net/api/public-v1/inbox/conversation/conv-abc123def456/reply" \
  -H "X-Secret-Key: your-secret-key-here" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "<p>Thank you for your message. I will review and respond soon.</p>",
    "reply_all": false
  }'
```

### Example Response

```json
{
  "data": {
    "message_id": "msg_reply789abc123",
    "in_reply_to": "msg_abc123def456",
    "from_email": "jane@taskip.com",
    "from_name": "Jane Smith",
    "to_email": "john.doe@client.com",
    "subject": "Re: Project Discussion - Website Redesign",
    "is_read": true,
    "delivered": true,
    "created_at": "just now",
    "uuid": "conv_abc123def456",
    "body_plain": "Thank you for your message. I will review and respond soon.",
    "body_html": "<p>Thank you for your message. I will review and respond soon.</p>",
    "error_message": null,
    "attachments": [],
    "reply_by": {
      "id": 12,
      "name": "Jane Smith",
      "email": "jane@taskip.com"
    }
  },
  "msg": "Message Send Successfully"
}
```

---

## Assign Tags to Conversation

Assign tags to organize and categorize conversations.

```http
POST /api/public-v1/inbox/conversation/{uuid}/assign-tags
```

### Path Parameters
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `uuid` | string | Yes | Conversation UUID |

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `tags` | array | Yes | Array of tag objects with label and optional color |

<ApiTester
  endpoint="/api/public-v1/inbox/conversation/conv-abc123def456/assign-tags"
  method="POST"
  defaultBody={{
    tag_ids: [1, 2, 5],
    replace_existing: false
  }}
  description="Test assigning tags to a conversation"
/>

### Example Request

```bash
curl -X POST "https://public-api.taskip.net/api/public-v1/inbox/conversation/conv-abc123def456/assign-tags" \
  -H "X-Secret-Key: your-secret-key-here" \
  -H "Content-Type: application/json" \
  -d '{
    "tags": [
      {"label": "Client Communication", "color": "blue"},
      {"label": "High Priority", "color": "red"},
      {"label": "Website Project"}
    ]
  }'
```

### Example Response

```json
{
  "msg": "Tag Assigned"
}
```

---

## Get Email Address

Retrieve the inbox email address configuration for receiving messages.

```http
GET /api/public-v1/get-email-address
```

<ApiTester
  endpoint="/api/public-v1/get-email-address"
  method="GET"
  description="Test getting inbox email address configuration"
/>

### Example Request

```bash
curl -X GET "https://public-api.taskip.net/api/public-v1/get-email-address" \
  -H "X-Secret-Key: your-secret-key-here" \
  -H "Content-Type: application/json"
```

### Example Response

```json
{
  "forwarding_email": "inbox-12345@taskip.net",
  "connected_email": "support@yourcompany.com",
  "verified_at": "2024-01-15T10:30:00Z",
  "forwarding_verified_at": "2024-01-15T11:00:00Z",
  "dns_verified_at": "2024-01-15T11:15:00Z"
}
```

---

```

---

## Update Tag Assignment

Update existing tag information.

```http
PUT /api/public-v1/inbox/assign-tags/{id}
```

### Path Parameters
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | integer | Yes | Tag ID to update |

### Request Body

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | string | Yes | Tag name (max 191 characters) |
| `color` | string | No | Tag color (max 98 characters) |

### Example Request

```bash
curl -X PUT "https://public-api.taskip.net/api/public-v1/inbox/assign-tags/1" \
  -H "X-Secret-Key: your-secret-key-here" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Updated Client Communication",
    "color": "green"
  }'
```

### Example Response

```json
{
  "msg": "Tag Updated Successfully"
}
```

<ApiTester
  endpoint="/api/public-v1/inbox/assign-tags/1"
  method="PUT"
  defaultBody={{
    name: "Updated Client Communication",
    color: "green"
  }}
  description="Test updating tag information"
/>

---

## Remove Tag Assignment

Delete a tag completely.

```http
DELETE /api/public-v1/inbox/assign-tags/{id}
```

### Path Parameters
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `id` | integer | Yes | Tag ID to delete |

### Example Request

```bash
curl -X DELETE "https://public-api.taskip.net/api/public-v1/inbox/assign-tags/1" \
  -H "X-Secret-Key: your-secret-key-here"
```

### Example Response

```json
{
  "msg": "Tag Deleted Successfully"
}
```

<ApiTester
  endpoint="/api/public-v1/inbox/assign-tags/1"
  method="DELETE"
  description="Test deleting a tag"
/>

---

<Callout type="info" emoji="📧">
  **Email Integration**: The Inbox API seamlessly integrates with popular email providers and supports IMAP/SMTP protocols for real-time message synchronization.
</Callout>

<Callout type="warning" emoji="🔒">
  **Security & Privacy**: All email communications are encrypted in transit and at rest. Access controls ensure only authorized team members can view conversations.
</Callout>

<Callout type="success" emoji="⚡">
  **Real-time Updates**: Conversations and messages are updated in real-time using WebSocket connections for instant notification delivery.
</Callout>